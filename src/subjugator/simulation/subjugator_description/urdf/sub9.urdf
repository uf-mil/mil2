<?xml version="1.0" ?>
<!-- =================================================================================== -->
<!-- |    This document was autogenerated by xacro from sub9.urdf.xacro                | -->
<!-- |    EDITING THIS FILE BY HAND IS NOT RECOMMENDED                                 | -->
<!-- =================================================================================== -->
<robot name="sub9" xmlns:experimental="http://sdformat.org/schemas/experimental" xmlns:gz="http://gazebosim.org/schema">
  <!--
    Example Xacro Macro for a Depth Sensor plugin.
    Usage in your main URDF/Xacro file (for example):
    
      <xacro:include filename="$(find subjugator_description)/xacro/depth.xacro" />
      
      <xacro:mil_depth_sensor
        name="depth_sensor"
        namespace="/depth"
        parent="base_link"
        xyz="0 0 -0.2"
        rpy="0 0 0"
        update_rate="10"
        frame_id="depth_sensor_frame"
      />
  -->
  <!-- KDL Parser does not like inertial base links, so use a 'fake' massless root link -->
  <link name="base_link"/>
  <joint name="fixed" type="fixed">
    <parent link="base_link"/>
    <child link="link1"/>
  </joint>
  <joint name="thrustjoint" type="revolute">
    <origin rpy="0 0 0" xyz="0 0 1"/>
    <parent link="link1"/>
    <child link="thrusterer"/>
    <!-- <gazebo> -->
    <limit effort="1000" lower="0.0" upper="0.548" velocity="0.5"/>
    <axis xyz="0 0 1"/>
    <!-- </gazebo>  -->
  </joint>
  <link name="thrusterer">
    <pose>1 0 0 0 0 0</pose>
    <inertial>
      <pose>0 0 0 0 0 0</pose>
      <mass value="0.1"/>
      <origin xyz="0 0 1"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>
  <!-- Base Link of the Sub -->
  <link name="link1">
    <inertial>
      <mass value="21.5"/>
      <inertia ixx="0.96105" ixy="0" ixz="0" iyy="1.799" iyz="0" izz="2.1286"/>
    </inertial>
    <visual name="visual">
      <origin rpy="0 0 0" xyz="-0.1 0.0125 -1"/>
      <geometry>
        <mesh filename="package://subjugator_description/urdf/meshes/Sub9.dae"/>
      </geometry>
    </visual>
    <!-- Imports subjugator's collisions from seperate XACRO -->
    <collision name="main_collision">
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.945 0.35 0.4"/>
      </geometry>
    </collision>
  </link>
  <gazebo>
    <plugin filename="gz-sim-hydrodynamics-system" name="gz::sim::systems::Hydrodynamics">
      <link_name>link1</link_name>
      <xDotU>-0.04876161</xDotU>
      <yDotV>-1.26324739</yDotV>
      <zDotW>-1.26324739</zDotW>
      <kDotP>0</kDotP>
      <mDotQ>-0.3346</mDotQ>
      <nDotR>-0.3346</nDotR>
      <xUabsU>-0.62282</xUabsU>
      <xU>-5</xU>
      <yVabsV>-60.127</yVabsV>
      <yV>-5</yV>
      <zWabsW>-6.0127</zWabsW>
      <zW>-100</zW>
      <kPabsP>-0.001916</kPabsP>
      <kP>-1</kP>
      <mQabsQ>-6.32698957</mQabsQ>
      <mQ>-1</mQ>
      <nRabsR>-6.32698957</nRabsR>
      <nR>-1</nR>
    </plugin>
    <plugin filename="gz-sim-thruster-system" name="gz::sim::systems::Thruster">
      <namespace>thrustme</namespace>
      <use_angvel_cmd>0</use_angvel_cmd>
      <joint_name>thrustjoint</joint_name>
      <thrust_coefficient>0.004422</thrust_coefficient>
      <fluid_density>1000</fluid_density>
      <propeller_diameter>0.2</propeller_diameter>
    </plugin>
  </gazebo>
  <link name="front_stereo"/>
  <joint name="front_stereo_to_link1" type="fixed">
    <parent link="link1"/>
    <child link="front_stereo"/>
    <origin rpy="0 0 0" xyz="0.2559 0 0.1707"/>
  </joint>
  <!-- <xacro:mil_camera name="front_left_cam" parent="front_stereo" namespace="/camera/front/left" xyz="-0.65 0 -0.3" rpy="0 0 9.5"/> -->
  <!-- <xacro:mil_camera name="front_right_cam" parent="front_stereo" namespace="/camera/front/right" xyz="0 -0.0445 0" rpy="0 0 0"/>
  <xacro:mil_camera name="down_left_cam" parent="base_link" namespace="/camera/down" xyz="0.054 0.105 -0.256" rpy="0 1.57 1.57"/> -->
  <link name="dvl_sensor"/>
  <joint name="dvl_sensor_joint" type="fixed">
    <origin rpy="0 0 0" xyz="0.21236 0.00254 -0.10233"/>
    <parent link="link1"/>
    <child link="dvl_sensor"/>
  </joint>
  <gazebo reference="dvl_sensor">
    <sensor gz:type="dvl" name="nortek_dvl500_300" type="custom">
      <pose>0 0 0 0 0 0</pose>
      <always_on>1</always_on>
      <update_rate>8</update_rate>
      <topic>/dvl/velocity</topic>
      <gz:dvl>
        <type>phased_array</type>
        <arrangement degrees="true">
          <beam id="1">
            <aperture>3</aperture>
            <rotation>-135</rotation>
            <tilt>25</tilt>
          </beam>
          <beam>
            <aperture>3</aperture>
            <rotation>135</rotation>
            <tilt>25</tilt>
          </beam>
          <beam>
            <aperture>3</aperture>
            <rotation>45</rotation>
            <tilt>25</tilt>
          </beam>
          <beam>
            <aperture>3</aperture>
            <rotation>-45</rotation>
            <tilt>25</tilt>
          </beam>
        </arrangement>
        <tracking>
          <water_mass_mode>
            <when>best</when>
            <water_velocity>
              <x>0.</x>
              <y>0.</y>
              <z>0.</z>
            </water_velocity>
            <boundaries>
              <near>10.</near>
              <far>100.</far>
            </boundaries>
            <bins>10</bins>
            <noise type="gaussian">
              <stddev>0.015</stddev>
            </noise>
            <visualize>true</visualize>
          </water_mass_mode>
          <bottom_mode>
            <when>best</when>
            <noise type="gaussian">
              <stddev>0.005</stddev>
            </noise>
            <visualize>true</visualize>
          </bottom_mode>
        </tracking>
        <maximum_range>200.</maximum_range>
        <minimum_range>0.3</minimum_range>
        <!-- ENU to FSD -->
        <reference_frame>0 0 0 3.14 0 -1.57</reference_frame>
      </gz:dvl>
    </sensor>
  </gazebo>
  <link name="imu"/>
  <joint name="imu_joint" type="fixed">
    <origin rpy="0 -1.571 0" xyz="0.21236 0.00254 -0.10233"/>
    <parent link="link1"/>
    <child link="imu"/>
  </joint>
  <gazebo reference="imu">
    <sensor name="imu_imu_sensor" type="imu">
      <always_on>true</always_on>
      <update_rate>210</update_rate>
      <topic>/imu/data_raw/imu</topic>
      <imu>
        <linear_acceleration>
          <x>
            <noise type="gaussian">
              <stddev>0.08825985</stddev>
            </noise>
          </x>
          <y>
            <noise type="gaussian">
              <stddev>0.08825985</stddev>
            </noise>
          </y>
          <z>
            <noise type="gaussian">
              <stddev>0.08825985</stddev>
            </noise>
          </z>
        </linear_acceleration>
        <angular_velocity>
          <x>
            <noise type="gaussian">
              <stddev>0.015707963</stddev>
            </noise>
          </x>
          <y>
            <noise type="gaussian">
              <stddev>0.015707963</stddev>
            </noise>
          </y>
          <z>
            <noise type="gaussian">
              <stddev>0.015707963</stddev>
            </noise>
          </z>
        </angular_velocity>
      </imu>
      <plugin filename="gz-sim-imu-system" name="gz::sim::systems::Imu">
        </plugin>
    </sensor>
    <sensor name="imu_mag_sensor" type="magnetometer">
      <always_on>true</always_on>
      <update_rate>210</update_rate>
      <topic>/imu/data_raw/imu_mag</topic>
      <plugin filename="gz-sim-magnetometer-system" name="gz::sim::systems::Magnetometer">
        </plugin>
    </sensor>
  </gazebo>
  <!-- Create a link for the depth sensor -->
  <link name="depth_sensor_link"/>
  <!-- Attach the link to the specified parent with a fixed joint -->
  <joint name="depth_sensor_joint" type="fixed">
    <parent link="base_link"/>
    <child link="depth_sensor_link"/>
    <origin rpy="0 0 0" xyz="0 0 -0.2"/>
  </joint>
  <!-- Insert the DepthSensor plugin into Gazebo -->
  <gazebo reference="depth_sensor_plugin">
    <plugin filename="libDepthSensor.so" name="depth_sensor_plugin">
      <!-- SDF parameters for your DepthSensor plugin -->
      <frame_id>depth_sensor_frame</frame_id>
      <offset>0 0 0 0 0 0</offset>
      <update_rate>10</update_rate>
    </plugin>
  </gazebo>
</robot>
